"use strict";function _interopDefault(ex){return ex&&"object"==typeof ex&&"default"in ex?ex.default:ex}function combine(array,values){var index=void 0;for(array=array.concat([]);(index=array.indexOf(void 0))!==-1&&values.length>0;)array[index]=values.shift();return array.concat(values)}function curry$(method){function transform(params){var context=void 0;return function(){for(var _len=arguments.length,input=Array(_len),_key=0;_key<_len;_key++)input[_key]=arguments[_key];var args=combine(params,array$(arguments));return context=context||this,args.length<method.length||args.some(function(it){return void 0===it})?transform(args):method.apply(context,args)}}return method.length<=1?method:transform([])}function negated$(it){return function(){return!it.apply(this,arguments)}}function pair(object){return Object.keys(object).map(function(key){return{key:key,value:object[key]}})}function flatten(array){var isArray=void 0,toArray$$1=void 0,fromArray=void 0;for(isArray=function(it){return it.constructor===Array},toArray$$1=function(it){return isArray(it)?it:[it]},fromArray=function(a,b){return a.concat(b)};array.some(isArray);)array=array.map(toArray$$1).reduce(fromArray);return array}function equals(reference,object){return("undefined"==typeof reference?"undefined":_typeof(reference))===("undefined"==typeof object?"undefined":_typeof(object))&&reference.constructor===object.constructor&&(reference.constructor!==Object?reference===object:flatten([pair(reference),pair(object)]).every(function(item){}))}function exists(it){return void 0!==it&&null!==it}function attempt(mutation,subject){var parameters=void 0,alternative=void 0,response=void 0;return parameters=array$(arguments).slice(1),alternative=1===parameters.length?parameters[0]:parameters,response=mutation.apply(this,parameters),response||alternative}function inject(it,transform){function cycle(key,value){return value!==copy&&("function"==typeof value?attempt(transform,value):"object"===("undefined"==typeof value?"undefined":_typeof(value))?inject(value,transform):void 0)}var copy={};for(var key in it)copy[key]=cycle(key,it[key]);return copy}function prepare(it){var not=void 0,tmp=void 0;return not=inject(it,negated$),not=inject(not,curry$),tmp=inject(it,curry$),tmp.not=not,tmp}function decompose(array,initial){var composer=function(previous,current){return attempt(current,previous)},reducer=function(it){return array.reduce(composer,initial||it)};return initial?reducer(initial):reducer}function configureProxy(it){return{host:it.host,port:it.port,path:"https://api.ipify.org",headers:{Host:"api.ipify.org"},agent:!1}}function configureSocks(it){var socksConfig={proxyHost:it.host,proxyPort:it.port,auths:[socks.auth.None()]};return{host:"api.ipify.org",port:443,path:"/",agent:new socks.HttpsAgent(socksConfig)}}var express=_interopDefault(require("express")),Socket=_interopDefault(require("socket.io")),program=require("commander"),chalk=require("chalk"),fs=require("fs"),os=require("os"),path=require("path"),http=require("http"),https=require("https"),cluster=require("cluster"),readline=require("readline"),socks=require("socksv5"),version="1.0.0",description="Proxy Test Tool for checking your proxies",_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj},classCallCheck=function(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")},createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),array$=function(it){return Array.prototype.slice.call(it,0)},has=curry$(function(object,property){return object.hasOwnProperty(property)}),is$={element:function(object){return object.nodeType===document.ELEMENT_NODE},fragment:function(object){return object.nodeType===document.DOCUMENT_FRAGMENT_NODE},text:function(object){return object.nodeType===document.TEXT_NODE},equal:equals,existant:exists};is$=prepare(is$);var Compare=function(){function Compare(reference){classCallCheck(this,Compare),this.reference=reference}return createClass(Compare,[{key:"element",value:function(object){var result=void 0,isElementNode=function(it){return it.nodeType===document.ELEMENT_NODE};return result=isElementNode(object),result===!this.reference.polarity}},{key:"fragment",value:function(object){var result=void 0,isDocumentFragmentNode=function(it){return it.nodeType===document.DOCUMENT_FRAGMENT_NODE};return result=isDocumentFragmentNode(object),result===!this.reference.polarity}},{key:"text",value:function(object){var isTextNode=function(it){return object.nodeType===document.TEXT_NODE};return result=isTextNode(object),result===!this.reference.polarity}},{key:"equals",value:function(object,$reference){}},{key:"existant",value:function(object){}}]),Compare}(),as={array:array$,pair:pair,method:curry$,flatten:flatten,decomposed:decompose,attempt:attempt},encoding="utf8",decode=function(it){return{host:it.match(/^[^:]+/m)[0],port:parseInt(it.match(/\d+$/m)[0],10)}},config={encoding:encoding};if(cluster.isMaster){var queue,completed;!function(){var app=express(),httpd=http.Server(app);Socket(httpd);app.use(express.static("public")),program.usage("-5 --file ../proxies.txt").version(version).description(description).option("-f, --file <input>","Parse an input file line by line").option("-5, --socks5","Test for SOCKet Secure Layer 5").option("-4, --socks4","Test for SOCKet Secure Layer 4").option("-j, --threads <amount>","Number of threads/clusters to run on").option("--port <port>","Set the httpd interface port to listen on").parse(process.argv);httpd.listen(program.port||null);program.port||console.log(chalk.yellow("Interface"),"Listening on port",chalk.blue(httpd.address().port));var threads$$1=program.threads||os.cpus().length,fromFileSystem=function(){if(!program.file)return!1;var realPath=path.resolve(program.file),readStream=fs.createReadStream(realPath,config);return readStream},input=as.decomposed([fromFileSystem],process.stdin),rl=readline.createInterface({input:input});cluster.setupMaster({});var distribute=function(workload){for(var id in cluster.workers)workload(cluster.workers[id])},count=function(){var i=0;return distribute(function(){return i++}),i};queue=[],completed=0;var attempt=function attempt(it){var amount=count(),assign=(amount+completed+queue.length,function(worker){worker.send(it),worker.on("message",function(message){console.log("Message",worker.id,message)}),worker.on("error",function(error){console.log("Error",error)}),worker.on("exit",function(){completed++,queue.length>0&&attempt(queue.shift())})});threads$$1>amount?assign(cluster.fork()):queue.push(it)};rl.on("line",function(it){attempt(it)})}()}cluster.isWorker&&process.on("message",function(message){var decoded=decode(message),proxyOptions=configureProxy(decoded),socksOptions=configureSocks(decoded),get$$1=function(options){return new Promise(function(resolve$$1,reject){process.send({message:"Sending Request"});try{https.get(options,function(response){var statusCode=response.statusCode,contentType=response.headers["content-type"],raw="";process.send({statusCode:statusCode,contentType:contentType}),200!==statusCode&&reject("Status Code "+statusCode),/^(text|application)\/json/.test(contentType)||reject("Content Type "+contentType),response.setEncoding(encoding),response.on("error",function(error){reject(error)}),response.on("data",function(data){raw+=data}),response.on("end",function(){resolve$$1(raw)})})}catch(exception){reject(exception)}})},passthrough=function(it){return process.send({message:it})};get$$1(socksOptions).then(passthrough).catch(passthrough),get$$1(proxyOptions).then(passthrough).catch(passthrough)});
//# sourceMappingURL=bin/index.min.js.map