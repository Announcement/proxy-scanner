{"version":3,"file":"index.js","sources":["../src/helpers.js","../src/ptt.js"],"sourcesContent":["// src/helpers.js https://github.com/Announcement/utemplate\r\n\r\n\r\n/** @module helpers */\r\n\r\n/**\r\n * Lazy way of turning an item into an Array\r\n * @function array$\r\n *\r\n * @param {Object} it - Array like object\r\n *\r\n * @return {Array} - implicit array object\r\n */\r\nlet array$ = function(it) {\r\n\treturn Array.prototype.slice.call(it, 0);\r\n};\r\n\r\n/**\r\n * Appends values to an Array,\r\n * but first replaces undefined values before adding to the end\r\n *\r\n * @function combine\r\n *\r\n * @param {Array} array - list of existing items\r\n * @param {Array} values - proposed additions to the lsit\r\n *\r\n * @return {Array} - collective array\r\n */\r\nfunction combine(array, values) {\r\n\tlet index;\r\n\r\n\tarray = array.concat([]);\r\n\r\n\twhile ((index = array.indexOf(undefined)) !== -1 && values.length > 0) {\r\n\t\tarray[index] = values.shift();\r\n\t}\r\n\r\n\treturn array.concat(values);\r\n}\r\n\r\n/**\r\n * Returns a modified function with lazy option assocations\r\n *\r\n * @function curry\r\n *\r\n * @param {Function} method - function to be curried\r\n *\r\n * @return {Function} curried functions\r\n */\r\nfunction curry$(method) {\r\n  /**\r\n  * Generated method through currying, allowing chainibility\r\n  * @function transform\r\n  *\r\n  * @see combine\r\n  * @this\r\n  *\r\n  * @param {Array} params - arguments array\r\n  *\r\n  * @return {Object} piped output from source curry method\r\n  */\r\n\tfunction transform(params) {\r\n\t\tlet context;\r\n\r\n\t\treturn function(...input) {\r\n\t\t\tlet args = combine(params, array$(arguments));\r\n\r\n\t\t\tcontext = context || this;\r\n\r\n\t\t\tif (args.length < method.length || args.some((it) => it === undefined )) {\r\n\t\t\t\treturn transform(args);\r\n\t\t\t} else {\r\n\t\t\t\treturn method.apply(context, args);\r\n\t\t\t}\r\n\t\t};\r\n\t}\r\n\treturn method.length <= 1 ? method : transform([]);\r\n}\r\n\r\n/**\r\n * Returns a modified version of a function with negated boolean output\r\n *\r\n * @function negated\r\n *\r\n * @param {Function} it - method to be negated\r\n *\r\n * @return {Function}\r\n */\r\nfunction negated$(it) {\r\n\treturn function() {\r\n\t\treturn !it.apply(this, arguments);\r\n\t};\r\n}\r\n\r\n/**\r\n * Pairs an object into a set of {key, value} arrays\r\n *\r\n * @function pair\r\n *\r\n * @param {Object} object - collection to be paired\r\n *\r\n * @return {Array.<{name: string, value}>}\r\n */\r\nfunction pair(object) {\r\n\treturn Object.keys(object).map((key) => {\r\n\t\treturn {key: key, value: object[key]};\r\n\t});\r\n}\r\n\r\n/**\r\n * Curried shortcut to hasOwnProperty\r\n *\r\n * @function has\r\n *\r\n * @param {Object} object - collection containing property\r\n * @param {String} property - property name to be checked\r\n *\r\n * @return {boolean}\r\n */\r\n\r\nlet has = curry$((object, property) => {\r\n\treturn object.hasOwnProperty(property);\r\n});\r\n\r\n/**\r\n * Recursively brings arrays to the highest level\r\n *\r\n * @function flatten\r\n *\r\n * @param {Array.<Array>} array - container of the set\r\n *\r\n * @return Array\r\n */\r\nfunction flatten(array) {\r\n\tlet isArray;\r\n\tlet toArray;\r\n\tlet fromArray;\r\n\r\n\tisArray = (it) => it.constructor === Array;\r\n\ttoArray = (it) => isArray(it) ? it : [it];\r\n\tfromArray = (a, b) => a.concat(b);\r\n\r\n\twhile (array.some(isArray)) {\r\n\t\tarray = array.map(toArray).reduce(fromArray);\r\n\t}\r\n\r\n\treturn array;\r\n}\r\n\r\n/**\r\n * Compares reference object to another object\r\n *\r\n * @function equals\r\n *\r\n * @see has\r\n * @see pair\r\n *\r\n * @param {Object} reference - what should be compared to\r\n * @param {Object} object - what we are comparing\r\n *\r\n * @return {boolean}\r\n */\r\nfunction equals(reference, object) {\r\n\t// Are they of the same type?\r\n\tif (typeof reference !== typeof object ||\r\n\t\t\treference.constructor !== object.constructor) {\r\n\t\treturn false;\r\n\t}\r\n\r\n\t// Do we need to check recursively?\r\n\tif (reference.constructor !== Object) {\r\n\t\treturn reference === object;\r\n\t}\r\n\r\n\treturn flatten([\r\n\t\tpair(reference),\r\n\t\tpair(object),\r\n\t])\r\n\t.every((item) => {\r\n\t\treturn;\r\n\t\thas(reference)(item.key) &&\r\n\t\thas(object)(item.key) &&\r\n\t\tequals(reference[item.key], object[item.key]);\r\n\t});\r\n}\r\n/**\r\n * Checks to see if an item exists (isn't null or undefined)\r\n * @function exists\r\n *\r\n * @param {Object} it - the item in question of existance\r\n *\r\n * @return {boolean}\r\n */\r\nfunction exists(it) {\r\n\treturn it !== undefined && it !== null;\r\n}\r\n\r\n/**\r\n * Attempts to apply mutation to subject, but returns the unmodified subject on failure\r\n *\r\n * @function attempt\r\n *\r\n * @see array$\r\n *\r\n * @param {Function} mutation - mutator function to be called on the subject\r\n * @param {Object} subject - any input that should be mutated\r\n *\r\n * @return {Object}\r\n */\r\nfunction attempt(mutation, subject) {\r\n\tlet parameters;\r\n\tlet alternative;\r\n\tlet response;\r\n\r\n\tparameters = array$(arguments).slice(1);\r\n\talternative = parameters.length === 1 ? parameters[0] : parameters;\r\n\r\n\tresponse = mutation.apply(this, parameters);\r\n\r\n\treturn response || alternative;\r\n}\r\n\r\n/**\r\n * Clones an object\r\n *\r\n * @function clone\r\n *\r\n * @param {Object} object - object to be cloned\r\n *\r\n * @return {Object}\r\n */\r\nfunction clone(object) {\r\n\treturn Object.assign({}, object);\r\n}\r\n\r\n/**\r\n * Injects a transformer into each element of a collection\r\n *\r\n * @name inject(it, transformer)\r\n *\r\n * @see attempt\r\n *\r\n * @param {Object} it - collection\r\n * @param {Function} tranform - mutator function\r\n *\r\n * @return {Object.<string, Function>}\r\n */\r\nfunction inject(it, transform) {\r\n\tlet copy = {};\r\n\r\n\tfunction cycle(key, value) {\r\n\t\tif (value === copy) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\r\n\t\tif (typeof value === 'function') {\r\n\t\t\treturn attempt(transform, value);\r\n\t\t}\r\n\r\n\t\tif (typeof value === 'object') {\r\n\t\t\treturn inject(value, transform);\r\n\t\t}\r\n\r\n\t\t// return value;\r\n\t}\r\n\r\n\tfor (let key in it) {\r\n\t\tcopy[key] = cycle(key, it[key]);\r\n\t}\r\n\r\n\treturn copy;\r\n};\r\n\r\n/**\r\n * Prepares function collection by currying and adding a not chain\r\n *\r\n * @name prepare(it)\r\n *\r\n * @see inject\r\n * @see negated$\r\n * @see curry$\r\n *\r\n * @param {Object.<string, Function>} it - collection of functions\r\n *\r\n * @return {Object.<string, Function>} - curried functions object\r\n */\r\nfunction prepare(it) {\r\n\tlet not, tmp;\r\n\r\n\tnot = inject(it, negated$);\r\n\tnot = inject(not, curry$);\r\n\ttmp = inject(it, curry$);\r\n\r\n\ttmp.not = not;\r\n\r\n\treturn tmp;\r\n}\r\n\r\n/**\r\n * Applies functions to a value and moves down the chain if possible\r\n *\r\n * @function decompose\r\n *\r\n * @see exists\r\n * @see attempt\r\n * @see array$\r\n *\r\n * @param {Array} array - list of functions to be applied\r\n * @param {Object} initial - optional initial item\r\n *\r\n * @return Object\r\n */\r\nfunction decompose(array, initial) {\r\n\tlet composer = (previous, current) => attempt(current, previous);\r\n\tlet reducer = (it) => array.reduce(composer, initial || it);\r\n\r\n\treturn initial ? reducer(initial) : reducer;\r\n}\r\n\r\nlet is$ = {\r\n\telement: (object) => {\r\n\t\t// return object instanceof Element;\r\n\t\treturn object.nodeType === document.ELEMENT_NODE;\r\n\t},\r\n\r\n\tfragment: (object) => {\r\n\t\t// return object.constructor === DocumentFragment;\r\n\t\treturn object.nodeType === document.DOCUMENT_FRAGMENT_NODE;\r\n\t},\r\n\r\n\ttext: (object) => {\r\n\t\t// return child.constructor === Text;\r\n\t\treturn object.nodeType === document.TEXT_NODE;\r\n\t},\r\n\r\n\tequal: equals,\r\n\texistant: exists,\r\n};\r\n\r\nis$ = prepare(is$);\r\n\r\nclass Compare {\r\n\tconstructor(reference) {\r\n\t\tthis.reference = reference;\r\n\t}\r\n\r\n\telement(object) {\r\n\t\tlet result;\r\n\r\n\t\tlet isElementNode = (it) =>\r\n\t\t\tit.nodeType === document.ELEMENT_NODE;\r\n\r\n\t\t// let isElement = it =>\r\n\t\t// \tobject instanceof Element;\r\n\r\n\t\tresult = isElementNode(object);\r\n\r\n\t\treturn result === !this.reference.polarity;\r\n\t}\r\n\r\n\tfragment(object) {\r\n\t\tlet result;\r\n\r\n\t\tlet isDocumentFragmentNode = (it) =>\r\n\t\t\tit.nodeType === document.DOCUMENT_FRAGMENT_NODE;\r\n\r\n\t\t// let isDocumentFragment = it =>\r\n\t\t// \tit.constructor === DocumentFragment;\r\n\r\n\t\tresult = isDocumentFragmentNode(object);\r\n\r\n\t\treturn result === !this.reference.polarity;\r\n\t}\r\n\r\n\ttext(object) {\r\n\t\tlet isTextNode = (it) =>\r\n\t\t\tobject.nodeType === document.TEXT_NODE;\r\n\r\n\t\t// let isText = it =>\r\n\t\t// \tchild.constructor === Text;\r\n\r\n\t\tresult = isTextNode(object);\r\n\r\n\t\treturn result === !this.reference.polarity;\r\n\t}\r\n\r\n\tequals(object, $reference) {\r\n\t\tlet reference = $reference || $reference;\r\n\t}\r\n\r\n\texistant(object) {\r\n\r\n\t}\r\n\r\n}\r\n\r\nexport let is = is$;\r\nexport let as = {\r\n\tarray: array$,\r\n\tpair: pair,\r\n\tmethod: curry$,\r\n\tflatten: flatten,\r\n\tdecomposed: decompose,\r\n\tattempt: attempt,\r\n};\r\n//\r\n// console.log(is$.not.equal({a: 'b'}, {a: 'b', c: 'd'}));\r\n","import { version, description } from '../package.json';\r\n\r\nimport {as} from './helpers';\r\n\r\nimport express from 'express';\r\nimport Socket from 'socket.io';\r\n\r\nimport * as program from 'commander';\r\nimport * as chalk from 'chalk';\r\nimport * as fs from 'fs';\r\nimport * as os from 'os';\r\nimport * as path from 'path';\r\nimport * as http from 'http';\r\nimport * as https from 'https';\r\nimport * as cluster from 'cluster';\r\nimport * as readline from 'readline';\r\nimport * as socks from 'socksv5';\r\n\r\nconst encoding = 'utf8';\r\n\r\n// Quick and Dirty File Line Parsing Decoder\r\nlet decode = it => {\r\n  return {\r\n    host: it.match(/^[^:]+/m)[0],\r\n    port: parseInt(it.match(/\\d+$/m)[0], 10)\r\n  };\r\n};\r\n\r\nlet config = {encoding};\r\n\r\n// HTTP Proxy Support\r\nfunction configureProxy(it) {\r\n  return {\r\n    host: it.host,\r\n    port: it.port,\r\n    path: 'https://api.ipify.org',\r\n    headers: {\r\n      Host: 'api.ipify.org'\r\n    },\r\n    agent: false\r\n  };\r\n}\r\n\r\n// SOCKSv5 Proxy Support\r\nfunction configureSocks(it) {\r\n  let socksConfig = {\r\n    proxyHost: it.host,\r\n    proxyPort: it.port,\r\n    auths: [ socks.auth.None() ]\r\n  };\r\n\r\n  return {\r\n    host: 'api.ipify.org',\r\n    port: 443,\r\n    path: '/',\r\n    agent: new socks.HttpsAgent(socksConfig)\r\n  };\r\n}\r\n\r\n// Main Process\r\nif (cluster.isMaster) {\r\n\r\n  // The HTTPd Interface\r\n  let app = express();\r\n  let httpd = http.Server(app);\r\n  let io = Socket(httpd);\r\n\r\n  // Serve the HTTPd Static Interface Driver\r\n  app.use(express.static('public'));\r\n\r\n  // Command Line Interface Configuration\r\n  program\r\n    // Example usage\r\n    .usage('-5 --file ../proxies.txt')\r\n\r\n    // Pulled from package.json\r\n    .version(version)\r\n    .description(description)\r\n\r\n    // Options\r\n    .option('-f, --file <input>', 'Parse an input file line by line')\r\n    .option('-5, --socks5', 'Test for SOCKet Secure Layer 5')\r\n    .option('-4, --socks4', 'Test for SOCKet Secure Layer 4')\r\n    .option('-j, --threads <amount>', 'Number of threads/clusters to run on')\r\n    .option('--port <port>', 'Set the httpd interface port to listen on')\r\n\r\n    // Provide it with arguments passed to the process\r\n    .parse(process.argv);\r\n\r\n  // Allow the HTTPd to listen on specified port\r\n  let listener = httpd.listen(program.port || null);\r\n\r\n  // If a port was not specified on the HTTPd, then output the assigned one\r\n  if(!program.port) {\r\n    console.log(chalk.yellow('Interface'), 'Listening on port', chalk.blue(httpd.address().port));\r\n  }\r\n\r\n  // Configure the amount of threads to be used\r\n  let threads = program.threads || os.cpus().length;\r\n\r\n  // File Systems Input Driver\r\n  let fromFileSystem = () => {\r\n    if (!program.file) return false;\r\n\r\n    // locate the file and prepare to read it\r\n    let realPath = path.resolve(program.file);\r\n    let readStream = fs.createReadStream(realPath, config);\r\n\r\n    return readStream;\r\n  }\r\n\r\n  // Load the best Input Driver\r\n  let input = as.decomposed([\r\n    fromFileSystem\r\n  ], process.stdin);\r\n\r\n  // Create a Readable Stream capable of line-by-line parsing\r\n  let rl = readline.createInterface({input});\r\n\r\n  // Silence children\r\n  cluster.setupMaster({\r\n    // silent: true\r\n  });\r\n\r\n  let distribute = (workload) => {\r\n    for (const id in cluster.workers) {\r\n      workload(cluster.workers[id]);\r\n    }\r\n  };\r\n\r\n  let count = () => {\r\n    var i = 0;\r\n    distribute(() => i++);\r\n    return i;\r\n  }\r\n\r\n  var queue = [];\r\n  var completed = 0;\r\n\r\n  let attempt = it => {\r\n    let amount = count();\r\n    let total = amount + completed + queue.length;\r\n\r\n    let assign = worker => {\r\n      worker.send(it);\r\n\r\n      worker.on('message', function(message) {\r\n        console.log('Message', worker.id, message);\r\n      });\r\n\r\n      worker.on('error', function(error) {\r\n        console.log('Error', error);\r\n      });\r\n\r\n      worker.on('exit', function() {\r\n        completed++;\r\n\r\n        if (queue.length > 0) {\r\n          attempt(queue.shift());\r\n        }\r\n      });\r\n    };\r\n\r\n    if (threads > amount) {\r\n      assign(cluster.fork());\r\n    } else {\r\n      queue.push(it);\r\n    }\r\n  }\r\n\r\n  // Run each line as a task\r\n  rl.on('line', it => { attempt(it) });\r\n}\r\n\r\n\r\n// Children Workers\r\nif (cluster.isWorker) {\r\n  process.on('message', function(message) {\r\n\r\n    // convert line into address:port\r\n    let decoded = decode(message);\r\n\r\n    // prepare each method\r\n    let proxyOptions = configureProxy(decoded);\r\n    let socksOptions = configureSocks(decoded);\r\n\r\n    // promises for ease of continuity\r\n    let get = (options) => {\r\n      return new Promise(function(resolve, reject) {\r\n        process.send({message: 'Sending Request'});\r\n        try {\r\n          let connection = https.get(options, (response) => {\r\n            const statusCode = response.statusCode;\r\n            const contentType = response.headers['content-type'];\r\n\r\n            var raw = '';\r\n\r\n            process.send({statusCode, contentType});\r\n\r\n            if (statusCode !== 200) {\r\n              reject(`Status Code ${statusCode}`);\r\n            }\r\n\r\n            if (!/^(text|application)\\/json/.test(contentType)) {\r\n              reject(`Content Type ${contentType}`);\r\n            }\r\n\r\n            response.setEncoding(encoding);\r\n\r\n            response.on('error', error => {\r\n              reject(error);\r\n            });\r\n\r\n            response.on('data', data => {\r\n              raw += data;\r\n            });\r\n\r\n            response.on('end', () => {\r\n              resolve(raw);\r\n            });\r\n          });\r\n        } catch (exception) {\r\n          reject(exception);\r\n        }\r\n      });\r\n    }\r\n\r\n    let passthrough = it => process.send({message: it});\r\n\r\n    let socks = get(socksOptions).then(passthrough).catch(passthrough);\r\n    let proxy = get(proxyOptions).then(passthrough).catch(passthrough);\r\n  });\r\n}\r\n"],"names":["array$","it","Array","prototype","slice","call","combine","array","values","index","concat","indexOf","undefined","length","shift","curry$","method","transform","params","context","input","args","arguments","some","apply","negated$","pair","object","Object","keys","map","key","value","has","property","hasOwnProperty","flatten","isArray","toArray","fromArray","constructor","a","b","reduce","equals","reference","every","item","exists","attempt","mutation","subject","parameters","alternative","response","inject","copy","cycle","prepare","not","tmp","decompose","initial","composer","previous","current","reducer","is$","nodeType","document","ELEMENT_NODE","DOCUMENT_FRAGMENT_NODE","TEXT_NODE","Compare","result","isElementNode","polarity","isDocumentFragmentNode","isTextNode","$reference","as","encoding","decode","match","parseInt","config","configureProxy","host","port","configureSocks","socksConfig","socks","None","cluster","queue","completed","app","express","httpd","http","io","Socket","use","static","version","description","option","parse","process","argv","listener","listen","program","log","chalk","address","threads","os","fromFileSystem","realPath","path","readStream","fs","decomposed","stdin","rl","readline","distribute","workload","id","count","i","amount","total","assign","send","on","message","worker","error","push","decoded","proxyOptions","socksOptions","get","options","Promise","resolve","reject","connection","https","statusCode","contentType","headers","raw","test","setEncoding","data","exception","passthrough","then","catch","proxy"],"mappings":"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"}