"use strict";function _interopDefault(ex){return ex&&"object"==typeof ex&&"default"in ex?ex.default:ex}function combine(array,values){var index=void 0;for(array=array.concat([]);(index=array.indexOf(void 0))!==-1&&values.length>0;)array[index]=values.shift();return array.concat(values)}function curry$(method){function transform(params){var context=void 0;return function(){for(var _len=arguments.length,input=Array(_len),_key=0;_key<_len;_key++)input[_key]=arguments[_key];var args=combine(params,array$(arguments));return context=context||this,args.length<method.length||args.some(function(it){return void 0===it})?transform(args):method.apply(context,args)}}return method.length<=1?method:transform([])}function negated$(it){return function(){return!it.apply(this,arguments)}}function pair(object){return Object.keys(object).map(function(key){return{key:key,value:object[key]}})}function flatten(array){var isArray=void 0,toArray$$1=void 0,fromArray=void 0;for(isArray=function(it){return it.constructor===Array},toArray$$1=function(it){return isArray(it)?it:[it]},fromArray=function(a,b){return a.concat(b)};array.some(isArray);)array=array.map(toArray$$1).reduce(fromArray);return array}function equals(reference,object){return("undefined"==typeof reference?"undefined":_typeof(reference))===("undefined"==typeof object?"undefined":_typeof(object))&&reference.constructor===object.constructor&&(reference.constructor!==Object?reference===object:flatten([pair(reference),pair(object)]).every(function(item){}))}function exists(it){return void 0!==it&&null!==it}function attempt(mutation,subject){var parameters=void 0,alternative=void 0,response=void 0;return parameters=array$(arguments).slice(1),alternative=1===parameters.length?parameters[0]:parameters,response=mutation.apply(this,parameters),response||alternative}function inject(it,transform){function cycle(key,value){return value!==copy&&("function"==typeof value?attempt(transform,value):"object"===("undefined"==typeof value?"undefined":_typeof(value))?inject(value,transform):void 0)}var copy={};for(var key in it)copy[key]=cycle(key,it[key]);return copy}function prepare(it){var not=void 0,tmp=void 0;return not=inject(it,negated$),not=inject(not,curry$),tmp=inject(it,curry$),tmp.not=not,tmp}function decompose(array,initial){var composer=function(previous,current){return attempt(current,previous)},reducer=function(it){return array.reduce(composer,initial||it)};return initial?reducer(initial):reducer}function configure(it){return{host:it.host,port:it.port,path:target,headers:{Host:target},agent:!1}}var program=require("commander"),chalk=require("chalk"),fs=require("fs"),os=require("os"),path=require("path"),http=require("http"),https=require("https"),cluster=require("cluster"),readline=require("readline"),socks=require("socksv5"),express=_interopDefault(require("express")),Socket=_interopDefault(require("socket.io")),version="1.0.0",description="Proxy Test Tool for checking your proxies",_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj},classCallCheck=function(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")},createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),array$=function(it){return Array.prototype.slice.call(it,0)},has=curry$(function(object,property){return object.hasOwnProperty(property)}),is$={element:function(object){return object.nodeType===document.ELEMENT_NODE},fragment:function(object){return object.nodeType===document.DOCUMENT_FRAGMENT_NODE},text:function(object){return object.nodeType===document.TEXT_NODE},equal:equals,existant:exists};is$=prepare(is$);var Compare=function(){function Compare(reference){classCallCheck(this,Compare),this.reference=reference}return createClass(Compare,[{key:"element",value:function(object){var result=void 0,isElementNode=function(it){return it.nodeType===document.ELEMENT_NODE};return result=isElementNode(object),result===!this.reference.polarity}},{key:"fragment",value:function(object){var result=void 0,isDocumentFragmentNode=function(it){return it.nodeType===document.DOCUMENT_FRAGMENT_NODE};return result=isDocumentFragmentNode(object),result===!this.reference.polarity}},{key:"text",value:function(object){var isTextNode=function(it){return object.nodeType===document.TEXT_NODE};return result=isTextNode(object),result===!this.reference.polarity}},{key:"equals",value:function(object,$reference){}},{key:"existant",value:function(object){}}]),Compare}(),as={array:array$,pair:pair,method:curry$,flatten:flatten,decomposed:decompose,attempt:attempt},decode=function(it){return{host:it.match(/^[^:]+/m)[0],port:parseInt(it.match(/\d+$/m)[0],10)}},encoding="utf8",config={encoding:encoding},target="https://api.ipify.org/?format=json";if(cluster.isMaster&&!function(){var app=express(),httpd=http.Server(app),io=Socket(httpd);app.use(express.static("public")),program.usage("-5 --file ../proxies.txt").version(version).description(description).option("-f, --file <input>","Parse an input file line by line").option("-5, --socks5","Test for SOCKet Secure Layer 5").option("-j, --threads","Number of threads/clusters to run on").option("--port <port>","Set the httpd interface port to listen on").parse(process.argv);httpd.listen(program.port||null);program.port||console.log(chalk.yellow("Interface"),"Listening on port",chalk.blue(httpd.address().port));var fromFileSystem=(program.threads||os.cpus().length,function(){if(!program.file)return!1;var realPath=path.resolve(program.file),readStream=fs.createReadStream(realPath,config);return readStream}),input=as.decomposed([fromFileSystem],process.stdin),rl=readline.createInterface({input:input});cluster.setupMaster({silent:!0});var Runner=function(){function Runner(callback){classCallCheck(this,Runner),this.callback=callback,this.running=0,this.completed=0,this.queue=[]}return createClass(Runner,[{key:"initialize",value:function(){var self=this;if(0===this.queue.length)return!1;if(this.running>0)return!1;this.running++;var item=this.queue.shift(),worker=cluster.fork();worker.send(item),worker.on("message",function(it){var amount=self.queue.length+self.running+self.completed;it.identity=worker.id,it.identifier=worker.process.pid;var progress=Math.round(worker.id/amount*100,2);process.stdout.clearLine(),process.stdout.cursorTo(0),process.stdout.write(progress+"% - "+worker.id+" @ "+it.status+" of "+amount+' "'+it.title+'"'),"Verified"===it.title&&console.log(it),io.emit("message",it)}),worker.on("exit",function(){self.running--,self.completed++,self.initialize()}),worker.on("error",function(error){console.log("An error has occured")})}},{key:"provide",value:function(information){this.queue.push(information),this.initialize()}}]),Runner}(),runner=new Runner(function(it){});rl.on("line",function(it){return runner.provide(it)})}(),cluster.isWorker){var time,increment;!function(){time=new Date,increment=0;var delay=function(){var now=new Date,difference=now-time;return time=now,difference},send=function(it,title){process.send({status:++increment,message:it,title:title||"Status update",elapsed:delay()})};process.on("message",function(message){var decoded=decode(message),proxyOptions=configure(decoded),socksOptions={proxyHost:decoded.host,proxyPort:decoded.port,auths:[socks.auth.None()]};send(decoded,"Decoded message");var responseCallback=function(response){send("Response has been acquired");var contentType=(response.statusCode,response.headers["content-type"]),raw="";200!==response.statusCode&&(send("bad status code","Request Error"),process.exit(0)),/^(text|application)\/json/.test(contentType)||(send("bad content-type","Request Error"),process.exit(0)),send("Headers verified"),response.setEncoding(encoding),response.on("data",function(data){send("Data packet received"),raw+=data}),response.on("end",function(){try{var parsed=JSON.parse(raw);send(parsed,"Verified")}catch(ex){send(ex.toString())}finally{process.exit(0)}}),response.on("error",function(error){send(error,"Response Error"),process.exit(0)})};send("Attempting SOCKSv5 Proxy Check"),https.get(socksOptions,responseCallback),send("Attempting HTTP Proxy Check"),https.get(proxyOptions,responseCallback)})}()}
//# sourceMappingURL=bin/index.min.js.map